<div class="container">
  <h1>Lobby</h1>
  <hr>

  <span class="nes-badge float-right" *ngIf="match?.options?.botCount">
    Bots: {{ match.options.botCount }}
  </span>
  <h2>Match: {{ match?.id }}</h2>

  <div class="row">
    <div class="col col-md-6">
      <label for="fighterSelection">Fighter</label>
      <div class=" nes-select" (ngsubmit)="join()">
        <select [(ngModel)]="fighterId" name="fighterSelection" id="fighterSelection">
          <option *ngFor="let fighter of fighters | async" value="{{ fighter.id }}">{{ fighter.name }}</option>
        </select>
      </div>
      <div>
        <button class="nes-btn is-success" (click)="join()">Join match</button>
        <button class="nes-btn is-error" (click)="leave()">Leave match</button>
        <button class="nes-btn" (click)="teamId=null;showTeamModal=true;">Create and join team</button>
        <button class="nes-btn" (click)="leaveTeam()">Leave team</button>
      </div>
    </div>
  </div>

  <div class="nes-container with-title " style="margin-top: 50px">
    <p class="title">KÃ¤mpfer in Lobby</p>

    <div class="team" [ngStyle]="{'border-color': getTeamColor(group.key)}"
      *ngFor="let group of (match?.registrations | orderBy: 'teamId' | groupBy: 'teamId')">

      <h4 *ngIf="group.key==='null'">No team</h4>
      <button class="nes-btn float-right" *ngIf="group.key!=='null' && fighterId"
        (click)="teamId=group.key; password=null;showTeamModal=true;">Join
        team</button>

      <span class="fighter-registration" *ngFor="let registration of group.value">
        <app-match-participant [registration]="registration"></app-match-participant>
      </span>
    </div>
  </div>
  <hr>
  <button class="nes-btn is-primary" style="width: 100%;" (click)="startMatch()" *ngIf="canStartMatch">Start
    match</button>
</div>

<div class="modal modal-dialog-centered" [ngStyle]="{ display: showTeamModal ? 'flex' : 'none' }">
  <div class="modal-dialog modal-content">
    <div class="modal-header">
      <h5 class="modal-title">Create team</h5>
      <button type="button" class="close" (click)="showTeamModal=false">
        <span>&times;</span>
      </button>
    </div>
    <div class="modal-body">
      <label>Password, leave blank if none</label>
      <input class="nes-input" type="text" [(ngModel)]="password">

      <button class="nes-btn col-md-4"
        (click)="teamId===null ? createAndJoinTeam() : joinTeam(teamId);showTeamModal=false;">Join
        team</button>
    </div>
  </div>
</div>